<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shu_Bear üêª</title>
    <style>
        :root {
            --bg-yellow: #FFFDE7;
            --blue-main: #1E88E5;
            --blue-dark: #0D47A1;
            --envelope-color: #1565C0;
            --paper-color: #ffffff;
            --heart-red: #e91e63;
        }

        body {
            display: flex; justify-content: center; align-items: center;
            height: 100vh; margin: 0; background-color: var(--bg-yellow);
            font-family: 'Arial', sans-serif; overflow: hidden;
        }

        /* TV SHUTDOWN STYLES */
        #tvOff {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: black; z-index: 9999; display: none;
        }
        .tv-static {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: url('https://media.giphy.com/media/oEI9uWU0WMrQmNwaE3/giphy.gif');
            opacity: 0.1; pointer-events: none;
        }
        /* Animation for the screen shrinking */
        .shutdown-anim {
            animation: tv-shrink 0.6s ease-in forwards;
        }
        @keyframes tv-shrink {
            0% { transform: scaleY(1) scaleX(1); background: white; }
            50% { transform: scaleY(0.01) scaleX(1); background: white; }
            100% { transform: scaleY(0) scaleX(0); background: white; }
        }

        /* Envelope Logic */
        .envelope-wrapper { position: relative; cursor: pointer; z-index: 10; }
        .envelope { position: relative; width: 300px; height: 200px; background-color: var(--envelope-color); border-radius: 0 0 10px 10px; }
        .envelope::before {
            content: ""; position: absolute; top: 0; z-index: 2;
            border-left: 150px solid transparent; border-right: 150px solid transparent;
            border-top: 110px solid #1976D2; transform-origin: top; transition: transform 0.6s ease;
        }
        .envelope-wrapper.open .envelope::before { transform: rotateX(180deg); z-index: 0; }
        
        .paper {
            position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%);
            width: 260px; height: 170px; background: var(--paper-color);
            padding: 20px; text-align: center; transition: all 0.6s ease;
            z-index: 1; display: flex; flex-direction: column; justify-content: center; align-items: center;
        }
        .paper-content { opacity: 0; transition: opacity 0.4s ease; pointer-events: none; }
        .envelope-wrapper.open .paper { transform: translateX(-50%) translateY(-140px); height: 280px; width: 320px; }
        .envelope-wrapper.open .paper-content { opacity: 1; pointer-events: auto; }

        /* Fixed cutoff for text */
        h2 { font-size: 1.4rem; line-height: 1.4; margin: 0; color: var(--blue-dark); }

        .heart-seal {
            position: absolute; top: 85px; left: 130px;
            width: 40px; height: 40px; background: var(--heart-red);
            transform: rotate(-45deg); z-index: 3; animation: pulse 1.5s infinite;
        }
        .heart-seal::before, .heart-seal::after { content: ""; position: absolute; width: 40px; height: 40px; background: var(--heart-red); border-radius: 50%; }
        .heart-seal::before { top: -20px; left: 0; }
        .heart-seal::after { left: 20px; top: 0; }
        @keyframes pulse { 0% { transform: rotate(-45deg) scale(1); } 50% { transform: rotate(-45deg) scale(1.2); } 100% { transform: rotate(-45deg) scale(1); } }
        
        .heart-particle {
            position: fixed; bottom: -20px; font-size: 24px;
            user-select: none; pointer-events: none; z-index: 1500;
            animation: floatUp linear forwards;
        }
        @keyframes floatUp {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(-110vh) rotate(360deg); opacity: 0; }
        }

        .btn { padding: 12px 25px; border: none; border-radius: 25px; cursor: pointer; font-weight: bold; }
        #noBtn { background: #FFEB3B; color: var(--blue-dark); border: 2px solid var(--blue-dark); position: fixed; z-index: 999; display: none; }

        #loadingScreen {
            display: none; flex-direction: column; align-items: center; justify-content: center;
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-yellow); z-index: 2000;
        }
        .progress-container { width: 300px; height: 15px; background: #e0e0e0; border-radius: 10px; overflow: hidden; margin-top: 20px; box-shadow: inset 0 2px 5px rgba(0,0,0,0.1); }
        .progress-bar { 
            width: 0%; height: 100%; background: linear-gradient(90deg, var(--blue-main), #64B5F6); 
            transition: width 0.1s linear; box-shadow: 0 0 10px var(--blue-main);
        }
        #statusText { color: var(--blue-dark); font-weight: bold; margin-top: 10px; text-align: center; }

        #photoContainer {
            display: none; position: fixed; top: 45%; left: 50%;
            transform: translate(-50%, -50%); z-index: 1000; text-align: center;
        }
        #finalMsg { opacity: 0; transition: opacity 2s ease; margin-bottom: 15px; }
        #finalPhoto { 
            width: 320px; height: 320px; object-fit: cover; 
            border: 12px solid white; border-radius: 20px;
            filter: blur(20px); transition: filter 6s ease;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        #secretSection {
            position: fixed; bottom: 30px; right: 30px;
            display: none; color: var(--blue-dark);
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
            padding: 20px; border-radius: 15px; 
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0,0,0,0.1); 
            z-index: 1100; opacity: 0; transition: opacity 1.5s ease;
            animation: heartbeat 2s infinite; max-width: 260px;
        }
        #secretStage3 { display: none; opacity: 0; transition: opacity 2.5s ease-in-out; }

        @keyframes heartbeat {
            0% { transform: scale(1); } 15% { transform: scale(1.05); } 30% { transform: scale(1); } 45% { transform: scale(1.05); } 100% { transform: scale(1); }
        }

        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1); width: 30px; height: 30px;
            border-radius: 50%; border-left-color: var(--blue-main);
            animation: spin 1s linear infinite; display: inline-block;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <div id="tvOff">
        <div class="tv-static"></div>
    </div>

    <audio id="bgMusic" src="music.mp3"></audio>

    <div class="envelope-wrapper" id="envelopeWrapper" onclick="openLetter()">
        <div class="heart-seal"></div>
        <div class="envelope">
            <div class="paper">
                <div class="paper-content">
                    <h2>Hey Shu_Bear, <br> Will you be my Valentine? üíô</h2>
                    <div style="display: flex; justify-content: center; gap: 20px; margin-top: 30px;">
                        <button class="btn" style="background:var(--blue-main); color:white;" onclick="startLoading(event)">Yes!</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <button class="btn" id="noBtn">No</button>

    <div id="loadingScreen">
        <p id="statusText">Initialising Heartbeat.exe...</p>
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
    </div>

    <div id="photoContainer">
        <h1 id="finalMsg" style="color: var(--blue-dark); font-size: 2.5rem;">Love You üòâ</h1>
        <img src="us.jpg" alt="Us" id="finalPhoto">
    </div>

    <div id="secretSection">
        <div id="secretStage1">
            <p style="margin:0 0 10px 0; font-weight:bold;">Hey, can I tell you a secret?</p>
            <button class="btn" style="background:var(--blue-main); color:white; width:100%;" onclick="revealSecret()">Yes</button>
        </div>
        <div id="secretStage2" style="display: none; text-align: center; padding: 10px;">
            <div class="spinner"></div>
            <p style="margin-top: 5px;">Downloading Feelings...</p>
        </div>
        <div id="secretStage3">
            <p style="margin:0; font-weight:bold; font-style:italic;">"I think you're amazing and it's crazy how into you I am."</p>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <script>
        const bgMusic = document.getElementById('bgMusic');
        let scale = 1.0;

        function openLetter() {
            document.getElementById('envelopeWrapper').classList.add('open');
            setTimeout(() => { 
                const no = document.getElementById('noBtn');
                no.style.display = 'block';
                no.style.left = '60%'; no.style.top = '50%';
            }, 600);
        }

        document.getElementById('noBtn').addEventListener('mouseenter', function() {
            this.style.left = Math.random() * (window.innerWidth - 100) + 'px';
            this.style.top = Math.random() * (window.innerHeight - 50) + 'px';
            if (scale > 0.2) { scale -= 0.1; this.style.transform = `scale(${scale})`; }
        });

        function createHeart() {
            const heart = document.createElement('div');
            heart.classList.add('heart-particle');
            const hearts = ['‚ù§Ô∏è', 'üíô', 'üíõ'];
            heart.innerHTML = hearts[Math.floor(Math.random() * hearts.length)];
            heart.style.left = Math.random() * 100 + 'vw';
            heart.style.animationDuration = (Math.random() * 3 + 2) + 's'; 
            document.body.appendChild(heart);
            setTimeout(() => heart.remove(), 5000);
        }

        function startLoading(e) {
            e.stopPropagation();
            bgMusic.play();
            setInterval(createHeart, 300);

            // TV SHUTDOWN LOGIC AT 2:35
            setTimeout(() => {
                const tv = document.getElementById('tvOff');
                tv.style.display = 'block';
                
                // Trigger the shrink animation after a tiny delay for the static to show
                setTimeout(() => {
                    tv.classList.add('shutdown-anim');
                    bgMusic.pause();
                }, 100);
            }, 155000); // 155 seconds = 2m 35s

            document.getElementById('envelopeWrapper').style.display = 'none';
            document.getElementById('noBtn').style.display = 'none';
            document.getElementById('loadingScreen').style.display = 'flex';

            let progress = 0;
            const timer = setInterval(() => {
                progress += 0.4;
                document.getElementById('progressBar').style.width = progress + '%';
                const status = document.getElementById('statusText');
                if (progress >= 25) status.innerText = "Scanning memories...";
                if (progress >= 60) status.innerText = "Optimizing vibes...";
                if (progress >= 100) {
                    clearInterval(timer);
                    status.innerText = "Success! ‚ù§Ô∏è";
                    setTimeout(showFinalReveal, 1500);
                }
            }, 100);
        }

        function showFinalReveal() {
            document.getElementById('loadingScreen').style.display = 'none';
            document.getElementById('photoContainer').style.display = 'block';
            setTimeout(() => { document.getElementById('finalMsg').style.opacity = '1'; }, 500);
            setTimeout(() => { document.getElementById('finalPhoto').style.filter = 'blur(0px)'; triggerFireworks(); }, 2000);
            setTimeout(() => { 
                const secret = document.getElementById('secretSection');
                secret.style.display = 'block';
                setTimeout(() => { secret.style.opacity = '1'; }, 100);
            }, 7000); 
        }

        function revealSecret() {
            document.getElementById('secretStage1').style.display = 'none';
            document.getElementById('secretStage2').style.display = 'block';
            setTimeout(() => {
                document.getElementById('secretStage2').style.display = 'none';
                const finalStage = document.getElementById('secretStage3');
                finalStage.style.display = 'block';
                setTimeout(() => { finalStage.style.opacity = '1'; }, 50);
            }, 4000);
        }

        function triggerFireworks() {
            const end = Date.now() + 5000;
            (function frame() {
                confetti({ particleCount: 3, angle: 60, spread: 55, origin: { x: 0 }, colors: ['#1E88E5', '#FDD835', '#E91E63'] });
                confetti({ particleCount: 3, angle: 120, spread: 55, origin: { x: 1 }, colors: ['#1E88E5', '#FDD835', '#E91E63'] });
                if (Date.now() < end) requestAnimationFrame(frame);
            }());
        }
    </script>
</body>
</html>